{"code_html": "\n<!doctype html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\">\n  <title>Password Recovery and Submission Demo</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n  <!-- Requirements mapping: Deliverables -> One file, semantic HTML, inline CSS & JS -->\n  <style>\n    /* Requirements mapping: Inclusivity -> readable defaults (large font, high contrast, spacing, no all-caps/italics) */\n    :root{\n      --bg:#ffffff;\n      --text:#111111;\n      --muted:#444444;\n      --accent:#0a66ff;\n      --good:#1a7f37;\n      --bad:#b3261e;\n      --border:#dddddd;\n      --focus:#ff8c00;\n      --card:#f7f8fa;\n    }\n    html,body{\n      margin:0;\n      padding:0;\n      background:var(--bg);\n      color:var(--text);\n      font-family: system-ui, -apple-system, \"Segoe UI\", Roboto, Arial, \"Noto Sans\", \"Helvetica Neue\", sans-serif;\n      font-size:18px; /* >=16px */\n      line-height:1.6; /* >=1.5 */\n    }\n    body.readable{\n      font-size:20px;\n      line-height:1.8;\n      letter-spacing:0.02em;\n      word-spacing:0.08em;\n    }\n    header, main, footer{\n      max-width: 960px;\n      margin: 0 auto;\n      padding: 1rem;\n    }\n    h1, h2, h3{\n      margin: 0.25rem 0 0.5rem;\n      font-weight: 700;\n    }\n    p{\n      margin: 0.25rem 0 0.75rem;\n    }\n    ul{\n      margin: 0.25rem 0 0.75rem 1.25rem;\n    }\n    .banner{\n      background: #fff6e5;\n      border: 2px solid #ffd27a;\n      color: #5b3d00;\n      padding: 0.6rem 0.8rem;\n      border-radius: 8px;\n      display: flex;\n      align-items: center;\n      gap: 0.6rem;\n      margin-top: 0.75rem;\n    }\n    .banner strong{\n      font-weight: 700;\n    }\n    .controls-row{\n      display:flex;\n      flex-wrap:wrap;\n      gap:0.5rem;\n      align-items:center;\n      justify-content: space-between;\n      margin-top:0.75rem;\n    }\n    .left-controls, .right-controls{\n      display:flex;\n      gap:0.5rem;\n      align-items:center;\n      flex-wrap:wrap;\n    }\n    .switch{\n      display:inline-flex;\n      align-items:center;\n      gap:0.4rem;\n    }\n    button, input, select, textarea{\n      font: inherit;\n    }\n    button, .btn{\n      background: var(--accent);\n      color: #fff;\n      border: none;\n      padding: 0.55rem 0.9rem;\n      border-radius: 8px;\n      cursor: pointer;\n    }\n    button.secondary{\n      background: #e6e6e6;\n      color: #111;\n    }\n    button.linklike{\n      background: transparent;\n      color: var(--accent);\n      text-decoration: underline;\n      padding: 0.25rem 0.25rem;\n    }\n    button:disabled{\n      opacity: 0.6;\n      cursor: not-allowed;\n    }\n    input[type=\"text\"], input[type=\"email\"], input[type=\"password\"]{\n      width: 100%;\n      padding: 0.55rem 0.6rem;\n      border: 2px solid var(--border);\n      border-radius: 8px;\n      background: #fff;\n      color: var(--text);\n    }\n    input[type=\"file\"]{\n      padding: 0.4rem 0;\n    }\n    label{\n      font-weight: 600;\n      display:block;\n      margin-bottom: 0.25rem;\n    }\n    .hint{\n      color: var(--muted);\n      font-size: 0.95rem;\n      margin-top: 0.25rem;\n    }\n    .field{\n      margin: 0.75rem 0 1rem;\n    }\n    .card{\n      background: var(--card);\n      border: 1px solid var(--border);\n      border-radius: 10px;\n      padding: 1rem;\n      margin: 0.5rem 0 1rem;\n    }\n    nav.stepbar{\n      margin-top: 0.5rem;\n      padding: 0.6rem 0.8rem;\n      border: 1px solid var(--border);\n      border-radius: 10px;\n      background: #fff;\n    }\n    .step-heading{\n      font-weight:700;\n    }\n    .actions{\n      display:flex;\n      gap:0.5rem;\n      flex-wrap: wrap;\n      margin-top: 0.75rem;\n    }\n    .row{\n      display:flex;\n      gap:0.5rem;\n      align-items:center;\n      flex-wrap:wrap;\n    }\n    .spaced{\n      margin-top: 0.75rem;\n    }\n    .status{\n      margin-top: 0.5rem;\n      min-height: 1.2rem;\n    }\n    .status .error{\n      color: var(--bad);\n      font-weight:600;\n    }\n    .status .ok{\n      color: var(--good);\n      font-weight:600;\n    }\n    .checklist{\n      list-style: none;\n      padding: 0;\n      margin: 0.25rem 0 0.75rem 0;\n    }\n    .checklist li{\n      display:flex;\n      align-items:center;\n      gap:0.5rem;\n      padding: 0.25rem 0;\n    }\n    .check{\n      width: 0.9rem;\n      height: 0.9rem;\n      border-radius: 999px;\n      border: 2px solid var(--border);\n      display:inline-block;\n      background: #fff;\n    }\n    .check.pass{\n      background: var(--good);\n      border-color: var(--good);\n    }\n    .sr-only{\n      position: absolute !important;\n      width: 1px; height: 1px;\n      padding: 0; margin: -1px;\n      overflow: hidden; clip: rect(0, 0, 0, 0);\n      white-space: nowrap; border: 0;\n    }\n    .helper-row{\n      display:flex;\n      gap:0.5rem;\n      align-items:center;\n      margin-top: 0.25rem;\n    }\n    .inline-btn{\n      padding: 0.35rem 0.6rem;\n      border-radius: 6px;\n      border: 1px solid var(--border);\n      background: #fff;\n      color: var(--accent);\n    }\n    /* Requirements mapping: keyboard navigable + visible focus */\n    :focus-visible{\n      outline: 3px solid var(--focus);\n      outline-offset: 2px;\n    }\n    a{\n      color: var(--accent);\n    }\n    footer{\n      color: var(--muted);\n      font-size: 0.95rem;\n      padding-bottom: 2rem;\n    }\n    .upload-result{\n      padding: 0.5rem 0.75rem;\n      border-left: 4px solid var(--good);\n      background: #eef9f0;\n      border-radius: 6px;\n      margin-top: 0.5rem;\n    }\n  </style>\n</head>\n<body>\n  <!-- Requirements mapping: Semantic sections (header, main, footer) -->\n  <header>\n    <h1>Password recovery and submission</h1>\n    <!-- Requirements mapping: Deadline banner showing time left until local midnight -->\n    <div class=\"banner\" aria-live=\"polite\" aria-atomic=\"true\">\n      <span aria-hidden=\"true\">⏰</span>\n      <strong>Time left today:</strong>\n      <span id=\"deadline-text\">--:--:--</span>\n      <span class=\"hint\">(to local midnight)</span>\n    </div>\n\n    <!-- Requirements mapping: Readable mode toggle + global Read Aloud/Copy controls -->\n    <div class=\"controls-row\">\n      <div class=\"left-controls\">\n        <label class=\"switch\">\n          <input type=\"checkbox\" id=\"readableToggle\" aria-describedby=\"readableDesc\">\n          <span>Readable mode</span>\n        </label>\n        <span id=\"readableDesc\" class=\"hint\">Bigger text and extra spacing.</span>\n      </div>\n      <div class=\"right-controls\" aria-label=\"Assistive controls\">\n        <button id=\"readAloudBtn\" class=\"inline-btn\" type=\"button\">Read aloud</button>\n        <button id=\"copyTextBtn\" class=\"inline-btn\" type=\"button\" hidden>Copy text</button>\n      </div>\n    </div>\n\n    <!-- Requirements mapping: ARIA live region for status messages (polite) -->\n    <div id=\"live\" class=\"sr-only\" role=\"status\" aria-live=\"polite\" aria-atomic=\"true\"></div>\n  </header>\n\n  <main id=\"app\" tabindex=\"-1\">\n    <!-- Filled by JS -->\n  </main>\n\n  <footer>\n    <!-- Requirements mapping: Concise, plain-language copy -->\n    <p>Demo only. Everything runs in your browser. No data is sent.</p>\n  </footer>\n\n  <script>\n    // Requirements mapping: Minimal inline JS state management and step navigation\n    const app = document.getElementById('app');\n    const live = document.getElementById('live');\n    const readableToggle = document.getElementById('readableToggle');\n    const readAloudBtn = document.getElementById('readAloudBtn');\n    const copyTextBtn = document.getElementById('copyTextBtn');\n\n    const Steps = ['Email', 'Code', 'Reset password', 'Login', 'Course'];\n    const state = {\n      step: 0,\n      email: '',\n      code: '',        // deterministic per email\n      newPassword: '',\n      lastUploadInfo: ''\n    };\n\n    // Requirements mapping: Readable mode toggle persists\n    const READABLE_KEY = 'demo-readable-mode';\n    function applyReadableMode(fromStorage) {\n      const on = fromStorage ?? (localStorage.getItem(READABLE_KEY) === 'on');\n      readableToggle.checked = on;\n      document.body.classList.toggle('readable', on);\n    }\n    readableToggle.addEventListener('change', () => {\n      const on = readableToggle.checked;\n      document.body.classList.toggle('readable', on);\n      localStorage.setItem(READABLE_KEY, on ? 'on' : 'off');\n      announce(on ? 'Readable mode on.' : 'Readable mode off.');\n    });\n    applyReadableMode();\n\n    // Requirements mapping: Deadline banner with live countdown\n    const deadlineEl = document.getElementById('deadline-text');\n    function nextMidnight() {\n      const now = new Date();\n      const next = new Date(now);\n      next.setHours(24,0,0,0);\n      return next;\n    }\n    function formatHHMMSS(ms) {\n      if (ms < 0) ms = 0;\n      const total = Math.floor(ms / 1000);\n      const h = String(Math.floor(total / 3600)).padStart(2,'0');\n      const m = String(Math.floor((total % 3600)/60)).padStart(2,'0');\n      const s = String(total % 60).padStart(2,'0');\n      return `${h}:${m}:${s}`;\n    }\n    function updateCountdown() {\n      const now = new Date();\n      let target = nextMidnight();\n      let diff = target - now;\n      if (diff < 0) {\n        target = nextMidnight();\n        diff = target - now;\n      }\n      deadlineEl.textContent = formatHHMMSS(diff);\n    }\n    updateCountdown();\n    setInterval(updateCountdown, 1000);\n\n    // Requirements mapping: Global Read Aloud button with fallback Copy Text\n    function supportsSpeech() {\n      return 'speechSynthesis' in window && typeof SpeechSynthesisUtterance !== 'undefined';\n    }\n    function getCurrentInstructionText() {\n      const list = document.querySelector('#instructions');\n      if (!list) return '';\n      return Array.from(list.querySelectorAll('li')).map(li => li.textContent.trim()).join('. ');\n    }\n    function readAloud() {\n      const text = getCurrentInstructionText() || 'No instructions on screen.';\n      if (supportsSpeech()) {\n        try {\n          window.speechSynthesis.cancel();\n          const u = new SpeechSynthesisUtterance(text);\n          u.lang = navigator.language || 'en-US';\n          u.rate = 1.0;\n          window.speechSynthesis.speak(u);\n          announce('Reading instructions.');\n        } catch(e) {\n          copyInstructions();\n        }\n      } else {\n        copyInstructions();\n      }\n    }\n    function copyInstructions() {\n      const text = getCurrentInstructionText();\n      if (!text) {\n        announce('Nothing to copy.');\n        return;\n      }\n      if (navigator.clipboard && navigator.clipboard.writeText) {\n        navigator.clipboard.writeText(text).then(() => {\n          announce('Instructions copied.');\n        }).catch(() => {\n          fallbackCopy(text);\n        });\n      } else {\n        fallbackCopy(text);\n      }\n    }\n    function fallbackCopy(text) {\n      const ta = document.createElement('textarea');\n      ta.value = text;\n      ta.setAttribute('readonly','');\n      ta.style.position = 'absolute';\n      ta.style.left = '-9999px';\n      document.body.appendChild(ta);\n      ta.select();\n      try { document.execCommand('copy'); announce('Instructions copied.'); }\n      catch(e){ announce('Copy failed.'); }\n      document.body.removeChild(ta);\n    }\n    function setupAssistButtons() {\n      const hasSpeech = supportsSpeech();\n      readAloudBtn.hidden = !hasSpeech;\n      copyTextBtn.hidden = hasSpeech; // show copy if speech unavailable\n      readAloudBtn.addEventListener('click', readAloud);\n      copyTextBtn.addEventListener('click', copyInstructions);\n    }\n    setupAssistButtons();\n\n    // Requirements mapping: ARIA live region helper\n    function announce(msg){\n      live.textContent = msg;\n    }\n\n    // Requirements mapping: Deterministic 6-digit recovery code from email\n    function codeForEmail(email) {\n      const s = (email || '').trim().toLowerCase();\n      let hash = 0;\n      for (let i = 0; i < s.length; i++) {\n        hash = (hash * 31 + s.charCodeAt(i)) % 1000000;\n      }\n      return String(hash).padStart(6, '0');\n    }\n\n    function sendCodeForCurrentEmail(reason = 'sent') {\n      state.code = codeForEmail(state.email);\n      const message = `Recovery code ${reason} for ${state.email}: ${state.code}`;\n      console.log(message); // Requirements mapping: Log key mock events -> code sent\n      announce('Code sent. Check the console.');\n    }\n\n    function setFocusTo(selector){\n      const el = app.querySelector(selector);\n      if (el) el.focus();\n    }\n\n    function render() {\n      const totalSteps = Steps.length;\n      // Step-specific instruction bullets (≤5 short bullets)\n      const instructionsMap = {\n        0: [\n          'Enter your email',\n          'We will show a 6‑digit code in the console',\n          'Keep this page open',\n          'Click Send code'\n        ],\n        1: [\n          'Open the console to see your code',\n          'Type the 6 digits',\n          'Click Verify',\n          'Need it again? Click Resend'\n        ],\n        2: [\n          'Create a new password',\n          'Follow the checklist',\n          'Confirm it matches',\n          'Click Save password'\n        ],\n        3: [\n          'Your email is filled',\n          'Enter your new password',\n          'Click Log in'\n        ],\n        4: [\n          'Pick your file',\n          'Click Upload',\n          'Wait for the success message'\n        ]\n      };\n      const stepName = Steps[state.step];\n\n      app.innerHTML = `\n        <!-- Requirements mapping: Step indicator with short bullet instructions -->\n        <nav class=\"stepbar\" aria-label=\"Progress\">\n          <div class=\"step-heading\">Step ${state.step+1} of ${totalSteps}: ${stepName}</div>\n          <ul id=\"instructions\">\n            ${instructionsMap[state.step].map(i => `<li>${i}</li>`).join('')}\n          </ul>\n        </nav>\n\n        ${renderStepContent(state.step)}\n      `;\n\n      // autofocus for the first control of each step\n      setTimeout(() => {\n        const auto = app.querySelector('[data-autofocus]');\n        if (auto) auto.focus();\n      }, 0);\n    }\n\n    function renderStepContent(step){\n      switch(step){\n        case 0: return emailStep();\n        case 1: return codeStep();\n        case 2: return resetStep();\n        case 3: return loginStep();\n        case 4: return courseStep();\n        default: return '<p>Unknown step.</p>';\n      }\n    }\n\n    // Requirements mapping: Back and Start over on each step\n    function navButtonsHtml({backDisabled=false} = {}){\n      return `\n        <div class=\"actions\">\n          <button type=\"button\" class=\"secondary\" id=\"backBtn\" ${backDisabled ? 'disabled' : ''}>Back</button>\n          <button type=\"button\" class=\"secondary\" id=\"startOverBtn\">Start over</button>\n        </div>\n      `;\n    }\n    function attachNavHandlers(){\n      const backBtn = document.getElementById('backBtn');\n      const startOverBtn = document.getElementById('startOverBtn');\n      if (backBtn){\n        backBtn.addEventListener('click', () => {\n          if (state.step > 0) {\n            state.step -= 1;\n            render();\n          }\n        });\n      }\n      if (startOverBtn){\n        startOverBtn.addEventListener('click', () => {\n          const keepReadable = localStorage.getItem(READABLE_KEY);\n          state.step = 0;\n          state.email = '';\n          state.code = '';\n          state.newPassword = '';\n          state.lastUploadInfo = '';\n          render();\n          if (keepReadable) localStorage.setItem(READABLE_KEY, keepReadable);\n          announce('Start over.');\n        });\n      }\n    }\n\n    // Requirements mapping: Email step\n    function emailStep(){\n      return `\n        <section class=\"card\" aria-labelledby=\"emailTitle\">\n          <h2 id=\"emailTitle\">Email</h2>\n          <form id=\"emailForm\" novalidate>\n            <div class=\"field\">\n              <label for=\"emailInput\">Email address</label>\n              <input id=\"emailInput\" name=\"email\" type=\"text\" autocomplete=\"email\" placeholder=\"you@example.edu\" value=\"${escapeHtml(state.email)}\" data-autofocus aria-describedby=\"emailHint\">\n              <div id=\"emailHint\" class=\"hint\">Any text is okay here for the demo.</div>\n            </div>\n            <div class=\"actions\">\n              <button id=\"sendCodeBtn\" type=\"submit\">Send code</button>\n            </div>\n            <div class=\"status\" id=\"emailStatus\"></div>\n          </form>\n          ${navButtonsHtml({backDisabled:true})}\n        </section>\n      `;\n    }\n\n    function wireEmailStep(){\n      const form = document.getElementById('emailForm');\n      const input = document.getElementById('emailInput');\n      const status = document.getElementById('emailStatus');\n      form.addEventListener('submit', (e) => {\n        e.preventDefault();\n        const val = input.value.trim();\n        if (!val){\n          status.innerHTML = `<span class=\"error\">Enter your email.</span>`;\n          announce('Enter your email.');\n          input.focus();\n          return;\n        }\n        state.email = val;\n        sendCodeForCurrentEmail('sent');\n        status.innerHTML = `<span class=\"ok\">Code sent. Check the console.</span>`;\n        state.step = 1;\n        render();\n      });\n      attachNavHandlers();\n    }\n\n    // Requirements mapping: Code step with single 6-digit input, verify and resend\n    function codeStep(){\n      return `\n        <section class=\"card\" aria-labelledby=\"codeTitle\">\n          <h2 id=\"codeTitle\">Enter code</h2>\n          <form id=\"codeForm\" novalidate>\n            <div class=\"field\">\n              <label for=\"codeInput\">6-digit code</label>\n              <input id=\"codeInput\" name=\"code\" inputmode=\"numeric\" pattern=\"[0-9]*\" maxlength=\"6\" placeholder=\"••••••\" data-autofocus aria-describedby=\"codeHint\">\n              <div id=\"codeHint\" class=\"hint\">Tip: open the console to see the code.</div>\n            </div>\n            <div class=\"actions\">\n              <button id=\"verifyBtn\" type=\"submit\">Verify</button>\n              <button id=\"resendBtn\" type=\"button\" class=\"secondary\">Resend</button>\n            </div>\n            <div class=\"status\" id=\"codeStatus\"></div>\n          </form>\n          ${navButtonsHtml()}\n        </section>\n      `;\n    }\n\n    function wireCodeStep(){\n      const input = document.getElementById('codeInput');\n      const status = document.getElementById('codeStatus');\n      const form = document.getElementById('codeForm');\n      const resend = document.getElementById('resendBtn');\n\n      // keep digits only\n      input.addEventListener('input', () => {\n        input.value = input.value.replace(/\\D+/g,'').slice(0,6);\n      });\n\n      form.addEventListener('submit', (e) => {\n        e.preventDefault();\n        const entered = input.value.trim();\n        console.log(`Verify attempt for ${state.email}: entered ${entered}`); // Requirements mapping: log verify attempts\n        if (entered === state.code){\n          status.innerHTML = `<span class=\"ok\">Code accepted.</span>`;\n          announce('Code accepted.');\n          state.step = 2;\n          render();\n        } else {\n          status.innerHTML = `<span class=\"error\">Wrong code.</span>`;\n          announce('Wrong code.');\n          input.focus();\n          input.select();\n        }\n      });\n      resend.addEventListener('click', () => {\n        sendCodeForCurrentEmail('re-sent');\n        status.innerHTML = `<span class=\"ok\">Code re-sent. Check the console.</span>`;\n        document.getElementById('codeInput').focus();\n      });\n\n      attachNavHandlers();\n    }\n\n    // Requirements mapping: Reset Password step with show/hide toggles and live checklist\n    function resetStep(){\n      return `\n        <section class=\"card\" aria-labelledby=\"resetTitle\">\n          <h2 id=\"resetTitle\">Make a new password</h2>\n          <form id=\"resetForm\" novalidate>\n            <div class=\"field\">\n              <label for=\"newPass\">New password</label>\n              <div class=\"row\">\n                <input id=\"newPass\" name=\"newPass\" type=\"password\" autocomplete=\"new-password\" data-autofocus aria-describedby=\"passHint\">\n                <button type=\"button\" class=\"inline-btn\" id=\"toggleNew\">Show</button>\n              </div>\n              <div id=\"passHint\" class=\"hint\">Use at least 8 characters, with letters and a number.</div>\n            </div>\n\n            <div class=\"field\">\n              <label for=\"confirmPass\">Confirm password</label>\n              <div class=\"row\">\n                <input id=\"confirmPass\" name=\"confirmPass\" type=\"password\" autocomplete=\"new-password\" aria-describedby=\"confirmHint\">\n                <button type=\"button\" class=\"inline-btn\" id=\"toggleConfirm\">Show</button>\n              </div>\n              <div id=\"confirmHint\" class=\"hint\">Re‑type the same password.</div>\n            </div>\n\n            <div class=\"card\" aria-live=\"polite\" aria-atomic=\"true\">\n              <h3 style=\"margin-top:0;\">Checklist</h3>\n              <ul class=\"checklist\" id=\"rulesList\">\n                <li><span class=\"check\" data-rule=\"len\"></span><span>At least 8 characters</span></li>\n                <li><span class=\"check\" data-rule=\"letter\"></span><span>Has a letter</span></li>\n                <li><span class=\"check\" data-rule=\"number\"></span><span>Has a number</span></li>\n                <li><span class=\"check\" data-rule=\"spaces\"></span><span>No spaces</span></li>\n              </ul>\n            </div>\n\n            <div class=\"actions\">\n              <button id=\"savePassBtn\" type=\"submit\">Save password</button>\n            </div>\n            <div class=\"status\" id=\"resetStatus\"></div>\n          </form>\n          ${navButtonsHtml()}\n        </section>\n      `;\n    }\n\n    function passRules(p) {\n      return {\n        len: p.length >= 8,\n        letter: /[A-Za-z]/.test(p),\n        number: /[0-9]/.test(p),\n        spaces: !/\\s/.test(p)\n      };\n    }\n\n    function wireResetStep(){\n      const newPass = document.getElementById('newPass');\n      const confirmPass = document.getElementById('confirmPass');\n      const toggleNew = document.getElementById('toggleNew');\n      const toggleConfirm = document.getElementById('toggleConfirm');\n      const rulesList = document.getElementById('rulesList');\n      const status = document.getElementById('resetStatus');\n      const form = document.getElementById('resetForm');\n\n      function updateChecklist() {\n        const rules = passRules(newPass.value);\n        rulesList.querySelectorAll('.check').forEach(dot => {\n          const key = dot.getAttribute('data-rule');\n          const pass = !!rules[key];\n          dot.classList.toggle('pass', pass);\n          dot.setAttribute('aria-label', pass ? 'Pass' : 'Fail');\n        });\n      }\n      newPass.addEventListener('input', updateChecklist);\n      updateChecklist();\n\n      function toggleVis(input, btn){\n        const show = input.type === 'password';\n        input.type = show ? 'text' : 'password';\n        btn.textContent = show ? 'Hide' : 'Show';\n        btn.setAttribute('aria-pressed', show ? 'true' : 'false');\n        input.focus();\n      }\n      toggleNew.addEventListener('click', () => toggleVis(newPass, toggleNew));\n      toggleConfirm.addEventListener('click', () => toggleVis(confirmPass, toggleConfirm));\n\n      form.addEventListener('submit', (e) => {\n        e.preventDefault();\n        const p1 = newPass.value;\n        const p2 = confirmPass.value;\n        const rules = passRules(p1);\n        const ok = Object.values(rules).every(Boolean);\n        if (!ok){\n          status.innerHTML = `<span class=\"error\">Meet all checklist items.</span>`;\n          announce('Please meet all checklist items.');\n          newPass.focus();\n          return;\n        }\n        if (p1 !== p2){\n          status.innerHTML = `<span class=\"error\">Passwords do not match.</span>`;\n          announce('Passwords do not match.');\n          confirmPass.focus();\n          return;\n        }\n        state.newPassword = p1;\n        console.log(`Password reset for ${state.email}`); // Requirements mapping: log password reset\n        status.innerHTML = `<span class=\"ok\">Password saved.</span>`;\n        announce('Password saved.');\n        state.step = 3;\n        render();\n      });\n\n      attachNavHandlers();\n    }\n\n    // Requirements mapping: Login step prefilled with email\n    function loginStep(){\n      return `\n        <section class=\"card\" aria-labelledby=\"loginTitle\">\n          <h2 id=\"loginTitle\">Log in</h2>\n          <form id=\"loginForm\" novalidate>\n            <div class=\"field\">\n              <label for=\"loginEmail\">Email</label>\n              <input id=\"loginEmail\" name=\"loginEmail\" type=\"text\" value=\"${escapeHtml(state.email)}\" readonly aria-describedby=\"loginEmailHint\" data-autofocus>\n              <div id=\"loginEmailHint\" class=\"hint\">We use the email you entered.</div>\n            </div>\n            <div class=\"field\">\n              <label for=\"loginPass\">Password</label>\n              <input id=\"loginPass\" name=\"loginPass\" type=\"password\" autocomplete=\"current-password\" aria-describedby=\"loginPassHint\">\n              <div id=\"loginPassHint\" class=\"hint\">Enter the new password you just set.</div>\n            </div>\n            <div class=\"actions\">\n              <button id=\"loginBtn\" type=\"submit\">Log in</button>\n            </div>\n            <div class=\"status\" id=\"loginStatus\"></div>\n          </form>\n          ${navButtonsHtml()}\n        </section>\n      `;\n    }\n\n    function wireLoginStep(){\n      const form = document.getElementById('loginForm');\n      const pass = document.getElementById('loginPass');\n      const status = document.getElementById('loginStatus');\n      form.addEventListener('submit', (e) => {\n        e.preventDefault();\n        if (pass.value === state.newPassword){\n          console.log(`Login success for ${state.email}`); // Requirements mapping: log login\n          status.innerHTML = `<span class=\"ok\">Logged in.</span>`;\n          announce('Logged in.');\n          state.step = 4;\n          render();\n        } else {\n          status.innerHTML = `<span class=\"error\">Wrong password.</span>`;\n          announce('Wrong password.');\n          pass.focus();\n          pass.select();\n        }\n      });\n      attachNavHandlers();\n    }\n\n    // Requirements mapping: Course page with upload control; simulated upload success\n    function courseStep(){\n      return `\n        <section class=\"card\" aria-labelledby=\"courseTitle\">\n          <h2 id=\"courseTitle\">Course page</h2>\n          <div class=\"card\" role=\"region\" aria-labelledby=\"courseCardTitle\">\n            <h3 id=\"courseCardTitle\" style=\"margin-top:0;\">CS101: Intro to AI</h3>\n            <p>Upload your assignment here.</p>\n            <div class=\"field\">\n              <label for=\"fileInput\">Your file</label>\n              <input id=\"fileInput\" type=\"file\" aria-describedby=\"fileHint\" data-autofocus>\n              <div id=\"fileHint\" class=\"hint\">Pick the correct file before upload.</div>\n            </div>\n            <div class=\"actions\">\n              <button id=\"uploadBtn\" type=\"button\">Upload</button>\n            </div>\n            <div id=\"uploadResult\" class=\"upload-result\" style=\"display:none;\"></div>\n          </div>\n          ${navButtonsHtml()}\n        </section>\n      `;\n    }\n\n    function wireCourseStep(){\n      const btn = document.getElementById('uploadBtn');\n      const input = document.getElementById('fileInput');\n      const result = document.getElementById('uploadResult');\n      btn.addEventListener('click', () => {\n        const file = input.files && input.files[0];\n        if (!file){\n          result.style.display = 'none';\n          announce('Choose a file first.');\n          return;\n        }\n        const when = new Date().toLocaleString();\n        const msg = `Uploaded ${file.name} at ${when}`;\n        console.log(`Upload success for ${state.email}: ${file.name} at ${when}`); // Requirements mapping: log upload\n        result.textContent = msg;\n        result.style.display = 'block';\n        announce('Upload complete.');\n      });\n      attachNavHandlers();\n    }\n\n    // Requirements mapping: keyboard + focus: after render, wire step-specific handlers\n    function afterRenderWire(step){\n      switch(step){\n        case 0: wireEmailStep(); break;\n        case 1: wireCodeStep(); break;\n        case 2: wireResetStep(); break;\n        case 3: wireLoginStep(); break;\n        case 4: wireCourseStep(); break;\n      }\n    }\n\n    // Utility to escape HTML in values\n    function escapeHtml(str){\n      return String(str || '').replace(/[&<>\"']/g, s => ({\n        '&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',\"'\":'&#039;'\n      }[s]));\n    }\n\n    // Initial code send if step 1 is reached via state (not in this demo, but safe)\n    function ensureCodeReady(){\n      if (state.step >= 1 && !state.code && state.email){\n        sendCodeForCurrentEmail('sent');\n      }\n    }\n\n    // Initial render\n    render();\n    afterRenderWire(state.step);\n    // Observe mutations to re-wire after each render\n    const originalRender = render;\n    render = function(){\n      originalRender.apply(this, arguments);\n      afterRenderWire(state.step);\n      ensureCodeReady();\n    };\n  </script>\n</body>\n</html>\n", "task_list": [], "evaluator_md": "SUMMARY\nThe single-file demo implements a complete, client-only password recovery and submission flow that matches the spec. It uses semantic HTML, inline CSS/JS, deterministic mock code delivery via console.log, short step-by-step instructions, readable design, assistive features (read aloud/copy), clear error feedback, and a visible deadline banner. Keyboard and screen reader considerations are present. Overall, it satisfies the functional and inclusivity requirements.\n\nFUNCTIONAL_CHECK\n- AC1: Single deliverable (index.html) with semantic HTML and inline CSS/JS — PASS. One HTML file with header/main/footer/section/nav; all CSS/JS inline.\n- AC2: Client-only; no backend/network calls — PASS. All logic in browser; no external requests.\n- AC3: Deterministic recovery code and mocked delivery — PASS. 6-digit code derived from email; delivery and attempts logged via console.log.\n- AC4: Complete flow: Email → Code → Reset → Login → Course upload — PASS. All steps implemented with back/start over controls.\n- AC5: Clear, concise content; short instructions (bullets ≤5); plain language — PASS. Each step has 3–4 bullets; concise labels and hints.\n- AC6: Readability support (font size, spacing, high contrast, no all-caps/italics) — PASS. Large font/line-height, high-contrast palette, no all-caps/italics.\n- AC7: Assist options to reduce reading load (listen or copy) — PASS. Global “Read aloud” button with fallback “Copy text” when speech not supported; instructions are the spoken/copied content.\n- AC8: Deadline visibility/time flexibility — PASS. Live countdown to local midnight shown in a banner; no forced timeouts.\n- AC9: Error handling and guidance — PASS. Simple messages, input focus/selection on errors, ARIA live announcements.\n- AC10: Accessibility: keyboard/focus/ARIA live — PASS. :focus-visible styling; autofocus per step; live region for status; inputs tied to hints via aria-describedby.\n- AC11: Password reset UX (show/hide, live checklist, confirm match) — PASS. Toggle visibility for both fields; live checklist; validation and clear feedback.\n- AC12: Course upload simulation and success feedback — PASS. File input with Upload button; success message and console log.\n- AC13: Spec mapping comments — PASS. “Requirements mapping” comments appear throughout.\n- AC14: No build step or external dependencies — PASS. Self-contained file; no frameworks/CDNs.\n\nFAILING_ITEMS\n- None observed against the provided requirements and inferred acceptance criteria.\n\nNEW_TASKS\n- No changes required.\n\nDECISION\nPASS", "done": true, "iter": 1, "step": 3}
